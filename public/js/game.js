(()=>{"use strict";class e{constructor(){}static setCookie(e,t,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var r="expires="+o.toUTCString();document.cookie=e+"="+t+";"+r+";path=/"}static setRandomCookieValue(e){let t=Math.ceil(e/13);return new Array(t).fill((function(){return Math.random().toString(16).substring(2,15)})).reduce(((e,t)=>e+t()),"").substring(0,e)}static getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var r=n[o];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""}static checkTokenValue(e,t){""==this.getCookie(e)&&this.setCookie(e,t,7)}}class t{constructor(){}static startGame(e,t){fetch("./api/new-game",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e,players:t,winner:"",word:"",turn:t[0].id,step:0,letters_accepted:[],letters_failed:[]})}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("error")?console.log(e.error):window.location.href="game"})).catch((function(e){console.error(e)}))}static async getGame(e){return await fetch("./api/get-game",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:e})}).then(await(function(e){return e.json()})).then(await(function(e){return e.hasOwnProperty("error")?e.error:e})).catch(await(function(e){console.error(e)}))}static setGame(e){fetch("./api/set-game",{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.json()})).then((function(e){e.hasOwnProperty("error")?console.log(e.error):console.log(e)})).catch((function(e){console.error(e)}))}}const n=["images/monster/monster0.jpg","images/monster/monster1.jpg","images/monster/monster2.jpg","images/monster/monster3.jpg","images/monster/monster4.jpg","images/monster/monster5.jpg"];function o(e,t){console.log(e);let n=e.split(""),o="";for(const e of n)" "==e?o+="&nbsp;&nbsp;":-1!=t.indexOf(e.toUpperCase())?o=o+e+" ":o+="_ ";return o}function r(e){let t=Array.from(new Set(e.letters_accepted)),n=e.word.replace(/ /g,""),o=Array.from(new Set(n.split("")));return JSON.stringify(t.sort())==JSON.stringify(o.sort())}window.onload=async function(){e.checkTokenValue("hangmanGameToken",e.setRandomCookieValue(15)),e.checkTokenValue("letter","black"),e.checkTokenValue("background","white"),document.body.style.background=e.getCookie("background");for(const t of document.getElementsByTagName("*"))t.style.color=e.getCookie("letter");const s=await t.getGame(e.getCookie("hangmanGameToken"));s.word=s.word.toUpperCase(),console.log(s);let a=function(e,t){for(let n of e)if(n.id==t)return n;return console.log("no player found"),null}(s.players,s.turn);console.log(a),document.getElementById("step").setAttribute("src",n[s.step]),document.getElementById("letters_failed").setAttribute("value",s.letters_failed),document.getElementById("word").innerHTML=o(s.word,s.letters_accepted),document.getElementById("player_name").innerHTML="Player: "+a.name,document.addEventListener("keydown",(function(e){if(1==(i=e.key).length&&"number"!=typeof i&&" "!=i){let i=function(e,t){if(e.word.includes(t.toUpperCase())){if(-1==e.letters_accepted.indexOf(t.toUpperCase()))return e.letters_accepted.push(t.toUpperCase()),"accepted"}else if(-1==e.letters_failed.indexOf(t.toUpperCase()))return e.letters_failed.push(t.toUpperCase()),"failed";return null}(s,e.key);if(null!=i&&"failed"==i){let e=s.players.indexOf(a);a=function(e,t){return t+1>=e.players.length?(document.getElementById("player_name").innerHTML="Player: "+e.players[0].name,e.players[0]):(document.getElementById("player_name").innerHTML="Player: "+e.players[t+1].name,e.players[t+1])}(s,e),s.step=s.step+1,document.getElementById("step").setAttribute("src",n[s.step])}document.getElementById("word").innerHTML=o(s.word,s.letters_accepted),document.getElementById("letters_failed").setAttribute("value",s.letters_failed),r(s)&&(console.log("winner"),s.winner=a.name),t.setGame(s),function(e){e.step>=5&&(window.location.href="finish"),r(e)&&(window.location.href="finish")}(s)}var i}))}})();